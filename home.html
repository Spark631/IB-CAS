<html>
<head>
  <title>Quizzard</title>
<link href="https://fonts.googleapis.com/css2?family=Irish+Grover&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=K2D&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
</head>
<style>
*{
  color: white;
  font-family: inter;
}
body {
   background-color: #222222;
   margin: 0;
}
#navbar {
   position: fixed;
   height: 87px;
   width: 100%;
   background-color: #262626;
   top: 0px;
   z-index: 99;
}

#logo {
   position: absolute;
   font-family: 'Irish Grover';
   font-size: 36px;
   top: 21px;
   left: 15%;
}

.menuItem {
   position: relative;
   font-size: 20px;
   top: 30px;
   float: right;
   right: 15%;
   margin-left: 50px;
}

#timer {
   position: relative;
   width: 30%;
   padding-left: 40px;
   padding-right: 40px;
   height: 127px;
   background-color: 171717;
   border-radius: 12px;
   left: 15%;
   top: 167px;
   outline: 4px solid #BC2727;
   outline-offset: -4px;
   font-family: 'K2D';
   font-size: 96px;
   text-align: center;
}

#milliseconds {
   font-size: 24px;
}

#question {
   position: relative;
   width: 30%;
   height: 180px;
   padding: 40px;
   background-color: 171717;
   border-radius: 12px;
   left: 15%;
   top: 200px;
   display: flex;
   justify-content: center;
   align-items: center;
   font-size: 16px;
}

#buzzer {
   position: relative;
   background-color: #BC2727;
   border-radius: 6px;
   height: 50px;
   width: 30%;
   padding-right: 40px;
   padding-left: 40px;
   display: flex;
   justify-content: center;
   align-items: center;
   font-size: 20px;
   top: 230px;
   left: 15%;
}

#previousQuestions {
   position: relative;
   background-color: #262626;
   border-radius: 6px;
   padding: 40px;
   width: 30%;
   height: 120px;
   margin-bottom: 350px;
   left: 15%;
   top: 260px;
}

#previousQuestionsBlocker {
   background-color: #1f1f1f;
   width: 100%;
   height: 100%;
   border-radius: 6px;
   border: 20px solid #1f1f1f;
   margin-left: -20px;
   margin-top: -20px;
   font-size: 14px;
   display: flex;
   justify-content: center;
   align-items: center;
}

#sidebar {
   position: absolute;
   background-color: #262626;
   right: 15%;
   width: 28%;
   height: 500px;
   top: 167px;
   border-radius: 6px;
}

#settings {
   position: absolute;
   background-color: #262626;
   right: 15%;
   width: 28%;
   height: 200px;
   top: 697px;
   border-radius: 6px;
}

#activityHeader {
   font-size: 20px;
   margin-left: 35px;
   margin-top: 40px;
}

#leaderboardHeader {
   font-size: 20px;
   margin-left: 35px;
   margin-top: 40px;
}

#activityFrame {
  margin-left: 35px;
  margin-right: 35px;
  margin-top: 15px;
  height: 135px;
  overflow-y: hidden;
}

.activity {
   font-size: 12px;
   background-color: #2E2E2E;
   border-radius: 4px;
   padding: 6px;
   text-align: center;
   margin-bottom: 8px;
}

.leaderboardLabel {
   font-size: 12px;
   margin-top: 20px;
   margin-left: 35px;
   display: inline-block;
}

#leaderboardFrame {
  margin-left: 35px;
  margin-right: 35px;
  margin-top: 7px;
  height: 140px;
  overflow-y: hidden;
  font-size: 12px;
}

.leaderboardRow {
   margin-bottom: 8px;
}

.points {
   display: inline-block;
   background-color: #2E2E2E;
   padding: 3px;
   width: 18%;
   border-radius: 4px;
   text-align: center;
}

.player {
   display: inline-block;
   background-color: #2E2E2E;
   margin-left: 4%;
   padding: 3px;
   width: 55px;
   border-radius: 4px;
   text-align: center;
   width: 74%;
}
#overlay {
  transition: 1.2s !important;
   background-color: 000000;
   position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.75);
  z-index: 9;
}
#joinRoomBox {
   transition: .8s !important;
   position: fixed;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%);
   width: 400px;
   background-color: #262626;
   z-index: 9999;
   padding: 40px;
   border-radius: 8px;
}
#joinRoomBoxTitle {
  font-weight: 800;
  font-size: 30px;
}
#joinRoomBoxSubtitle {
  margin-top: 25px;
  font-weight: 500;
  margin-bottom: 15px;
}
#room-input {
  background-color: #222222;
  width: 100%;
  border: 4px solid white;
  border-radius: 6px;
  height: 45px;
  margin-bottom: 15px;
}
#joinRoomButton {
  transition: .5s;
  cursor: pointer;
  background-color: #BC2727;
  border: none;
  border-radius: 6px;
  width: 175px;
  height: 35px;
  margin-bottom: 30px;
}
#joinRoomButton:hover {
  border: 1px solid white;
}
#joinRandomRoomButton {
  transition: .5s;
  cursor: pointer;
  background-color: #BC2727;
  border: none;
  border-radius: 6px;
  width: 225px;
  height: 35px;
  margin-top: 30px;
}
#joinRandomRoomButton:hover {
  border: 1px solid white;
}
</style>
<body>
<div id="navbar">
    <span id="logo">Quizzer</span>
    <span class="menuItem">Settings</span>
    <span class="menuItem">Donate</span>
    <span class="menuItem">About</span>
    <span class="menuItem">Change Room</span>
</div>

<div id="overlay"></div>
<div id="joinRoomBox">
   <div id="joinRoomBoxTitle">Join A Room</div>
   <div id="joinRoomBoxSubtitle">Room Code</div>
   <input type="text" id="room-input" placeholder="   Room Code" />
   <button id="joinRoomButton" onclick="joinRoom()">Join</button>
   <br />-or-<br />
   <button id="joinRandomRoomButton" onclick="joinRandomRoom()">Create Random</button>
  <button onclick="leaveRoom()" style="color: black;">Leave Room</button><!-- leave automatically -->

  <div id="chat">
    <input type="text" id="message-input" style="color: black;" placeholder="Type an answer" />
    <button onclick="sendMessage()" style="color: black;">Send</button>
    <ul id="messages"></ul>
  </div>
</div>

<div id="timer">
     <span id="minutes">10</span>:<span id="seconds">00</span><span id="milliseconds">.00</span>
</div>

<div id="question">The creation of this type of substance generally starts by putting atoms in a
magneto-optical trap, immediately followed by an evaporative method. In 
attempting the first synthesis of this type of substance, Wolfgang Ketterle
 worked with sodium atoms, while contemporaneously Eric Cornell and Carl 
Wieman succeeded with rubidium atoms. Atoms in this type of substance
are all at the lowest quantum level. For 10 points, name this "fifth state of
matter" in which atoms are</div>

<div id="buzzer"><b>Buzz In</b></div>

<div id="previousQuestions"><div id="previousQuestionsBlocker"><u>Show Previous Questions</u></div></div>

<div id="sidebar">
   <div id="activityHeader"><b>Activity:</b></div>
   <div id="activityFrame">
       <div class="activity"><b>&nbsp;</b> </div>
       <div class="activity"><b> &nbsp;</b> </div>
       <div class="activity"><b> &nbsp;</b> </div>
       <div class="activity"><b> &nbsp;</b> </div>
   </div>

   <div id="leaderboardHeader"><b>Leaderboard:</b></div>
   <div class="leaderboardLabel">Points</div>
   <div class="leaderboardLabel">Player</div>
   <div id="leaderboardFrame">
    <table id="pointTable">
      <thead>
        <tr>
          <th>Points</th>
          <th>Player</th>
        </tr>
      </thead>
      <tbody id="scoreboard">
      </tbody>
    </table>
       <div class="leaderboardRow"><div class="points">10</div><div class="player">Derek</div></div>
       <div class="leaderboardRow"><div class="points">0</div><div class="player">Donny</div></div>
       <div class="leaderboardRow"><div class="points">10</div><div class="player">Derek</div></div>
       <div class="leaderboardRow"><div class="points">0</div><div class="player">Donny</div></div>
       <div class="leaderboardRow"><div class="points">10</div><div class="player">Derek</div></div>
       <div class="leaderboardRow"><div class="points">0</div><div class="player">Donny</div></div>
       <div class="leaderboardRow"><div class="points">10</div><div class="player">Derek</div></div>
       <div class="leaderboardRow"><div class="points">0</div><div class="player">Donny</div></div>
   </div>
</div>

<div id="settings">
</div>
<ul id="usersList"></ul>

<script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const adjectives = ['Happy', 'Brave', 'Clever', 'Sunny', 'Kind', 'Playful', 'Witty', 'Gentle', 'Vibrant'];
const nouns = ['Cat', 'Dog', 'Bird', 'Sun', 'Moon', 'Flower', 'Star', 'Tree', 'Ocean'];
const table = document.getElementById('scoreboard');

function generateRandomUsername() {
  const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];
  const noun = nouns[Math.floor(Math.random() * nouns.length)];
  const number = Math.floor(Math.random() * 1000);

  return adjective + noun + number;
}

function sortTable() {
  const table = document.getElementById('pointTable');
  const tbody = table.getElementsByTagName('tbody')[0];
  const rows = Array.from(tbody.getElementsByTagName('tr'));

  rows.sort((a, b) => {
    const cellA = a.getElementsByTagName('td')[0].textContent;
    const cellB = b.getElementsByTagName('td')[0].textContent;
    return cellB - cellA;
  });

  rows.forEach(row => tbody.appendChild(row));
}

    socket.on('usersInRoom', (users) => {
      users.forEach((user) => {
        table.innerHTML = users.map(user => `<tr><td>${user.score}</td><td>${user.username}</td></tr>`).join('');
        sortTable();
      });
    });

    let playerId = localStorage.getItem('playerId');
    if (!playerId) {
      playerId = generateRandomUsername();
      localStorage.setItem('playerId', playerId);
      socket.emit('setPlayerId', playerId);
    } else {
      socket.emit('setPlayerId', playerId);
    }

    function joinRoom() {
      const room = document.getElementById('room-input').value;
      socket.emit('joinRoom', room);
      document.getElementById('overlay').style.opacity = 0;
      document.getElementById('joinRoomBox').style.opacity = 0;
      document.getElementById('settings').innerHTML = "Room code: " + room; // update this with new website
      socket.emit('getUsersInRoom', room);
      document.getElementById('activityFrame').insertAdjacentHTML('afterbegin', '<div class="activity"><b>' + playerId + '</b> has joined the room!</div>');
    }

    function joinRandomRoom() {
      const room = Math.floor(Math.random() * 10000) + 1;
      socket.emit('joinRoom', room);
      document.getElementById('overlay').style.opacity = 0;
      document.getElementById('joinRoomBox').style.opacity = 0;
      document.getElementById('settings').innerHTML = "Room code: " + room; // update this with new website
      document.getElementById('activityFrame').insertAdjacentHTML('afterbegin', '<div class="activity"><b>' + playerId + '</b> has joined the room!</div>');
    }

    function updateScore(score) {
        socket.emit('updateScore', score);
    }

    function leaveRoom() {
      const room = document.getElementById('room-input').value;
      socket.emit('leaveRoom', room);
    }

    function sendMessage() {
      const room = document.getElementById('room-input').value;
      const message = document.getElementById('message-input').value;
      socket.emit('chatMessage', room, message);
      document.getElementById('message-input').value = '';
    }

    socket.on('userJoined', (username) => {
    const room = document.getElementById('room-input').value;
    socket.emit('getUsersInRoom', room);
    document.getElementById('activityFrame').insertAdjacentHTML('afterbegin', '<div class="activity"><b>' + username + '</b> has joined the room!</div>');
  });

  socket.on('userLeft', (username) => {
    const room = document.getElementById('room-input').value;
    socket.emit('getUsersInRoom', room);
    document.getElementById('activityFrame').insertAdjacentHTML('afterbegin', '<div class="activity"><b>' + username + '</b> returned to the abyss.</div>');
  });

    socket.on('chatMessage', (message) => {
      const messages = document.getElementById('messages');
      const li = document.createElement('li');
      li.textContent = message;
      messages.appendChild(li);
    });
  </script>

</body>
</html>
